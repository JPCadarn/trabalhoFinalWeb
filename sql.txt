CREATE DATABASE gole;

CREATE TABLE usuarios (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	email VARCHAR(60) NOT NULL UNIQUE,
	senha VARCHAR(60) NOT NULL,
	nome VARCHAR(100) NOT NULL,
	cpf VARCHAR(14) NOT NULL UNIQUE,
	data_nascimento DATE NOT NULL,
	admin BOOLEAN NOT NULL DEFAULT false,
	criacao DATETIME NOT NULL DEFAULT NOW()
);

CREATE TABLE categorias (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	nome VARCHAR(60) NOT NULL UNIQUE
);

CREATE TABLE cartaos (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	usuario_id INT NOT NULL REFERENCES usuarios(id),
	ultimos_quatro INT NOT NULL,
	codigo_seguranca VARCHAR(60) NOT NULL,
	numero VARCHAR(60) NOT NULL,
	validade VARCHAR(5) NOT NULL,
	debito_credito VARCHAR(1) NOT NULL,
	nome_impresso VARCHAR(100) NOT NULL
);

CREATE TABLE produtos ( 
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	nome VARCHAR(60) NOT NULL,
	descricao TEXT NOT NULL,
	valor NUMERIC(10, 2) NOT NULL,
	categoria_id INT NOT NULL REFERENCES categorias(id),
	imagem VARCHAR(200) NOT NULL,
	teor_alcoolico NUMERIC(10, 2) DEFAULT 0.0
);

CREATE TABLE usuarios_acessos (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	usuario_id INT NOT NULL REFERENCES usuarios(id),
	data DATE NOT NULL,
	hora TIME NOT NULL
);

CREATE TABLE produtos_acessos (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	produto_id INT NOT NULL REFERENCES produtos(id),
	data DATE NOT NULL,
	hora TIME NOT NULL
);

CREATE TABLE produtos_destaque (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	produto_id INT NOT NULL REFERENCES produtos(id),
	ordem INT NOT NULL
);

CREATE TABLE carrinhos (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	usuario_id INT NOT NULL REFERENCES usuarios(id),
	produto_id INT NOT NULL REFERENCES produtos(id),
	quantidade INT DEFAULT 1
);

CREATE TABLE avaliacaos (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	nota INT NOT NULL,
	usuario_id INT NOT NULL REFERENCES usuarios(id),
	produto_id INT NOT NULL REFERENCES produtos(id),
	texto TEXT NOT NULL
);

CREATE TABLE enderecos (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	usuario_id INT NOT NULL REFERENCES usuarios(id),
	cep VARCHAR(9) NOT NULL,
	destinatario VARCHAR(100) NOT NULL,
	rua VARCHAR(100) NOT NULL,
	bairro VARCHAR(50) NOT NULL,
	numero INT NOT NULL,
	complemento VARCHAR(30),
	cidade VARCHAR(30) NOT NULL,
	estado VARCHAR(30) NOT NULL,
	referencia VARCHAR(50)
);

CREATE TABLE pedidos (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	usuario_id INT NOT NULL REFERENCES usuarios(id),
	data VARCHAR(10) NOT NULL,
	hora VARCHAR(8) NOT NULL,
	endereco_id INT NOT NULL REFERENCES enderecos(id),
	cartao_id INT REFERENCES cartaos(id),
	parcelas INT NOT NULL DEFAULT 1
);

CREATE TABLE pedidos_itens (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	pedido_id INT NOT NULL REFERENCES pedidos(id),
	produto_id INT NOT NULL REFERENCES produtos(id),
	quantidade INT NOT NULL,
	valor_total NUMERIC(15, 2)
);